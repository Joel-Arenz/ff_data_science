<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy Points Predictions 2024</title>
    <style>
        /* Allgemeine Einstellungen */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-top: 50px;
        }

        h2 {
            color: #333;
            margin-top: 30px;
            text-align: center;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Formularbereich */
        form {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        label {
            font-size: 16px;
            color: #333;
        }

        select, button {
            padding: 10px 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
        }

        select:focus, button:focus {
            outline: none;
            border-color: #007bff;
        }

        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Tabelle */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        th.sortable::after {
            content: " ðŸ”½";
        }

        th.sortable.sorted-asc::after {
            content: " ðŸ”¼";
        }

        th.sortable.sorted-desc::after {
            content: " ðŸ”½";
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Fantasy Points Predictions 2024</h1>

        <form method="get">
            <div>
                <label for="week">Woche:</label>
                <select name="week" id="week">
                    <option value="">Alle</option>
                    {% for week in weeks %}
                        <option value="{{ week }}" {% if week == selected_week %}selected{% endif %}>{{ week }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label for="position">Position:</label>
                <select name="position" id="position">
                    <option value="">Alle</option>
                    {% for position in positions %}
                        <option value="{{ position }}" {% if position == selected_position %}selected{% endif %}>{{ position }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label for="name">Spieler:</label>
                <select name="name" id="name">
                    <option value="">Alle</option>
                    {% for name in names %}
                        <option value="{{ name }}" {% if name == selected_name %}selected{% endif %}>{{ name }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit">Filtern</button>
        </form>

        <h2>Gefilterte Spieler</h2>
        <table id="playerTable">
            <thead>
                <tr>
                    <th class="sortable" onclick="sortTable(0)">Player ID</th>
                    <th class="sortable" onclick="sortTable(1)">Spieler</th>
                    <th class="sortable" onclick="sortTable(2)">Woche</th>
                    <th class="sortable" onclick="sortTable(3)">Team</th>
                    <th class="sortable" onclick="sortTable(4)">Gegner</th>
                    <th class="sortable" onclick="sortTable(5)">Vorhergesagte Fantasy Punkte</th>
                    <th class="sortable" onclick="sortTable(6)">Fantasy Punkte</th>
                </tr>
            </thead>
            <tbody>
                {% for row in data %}
                    <tr>
                        <td>{{ row.player_id }}</td>
                        <td>{{ row.name }}</td>
                        <td>{{ row.week }}</td>
                        <td>{{ row.recent_team }}</td>
                        <td>{{ row.opponent_team }}</td>
                        <td>{{ row.predicted_fantasy_points }}</td>
                        <td>{{ row.fantasy_points }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <script>
        let currentSortColumn = -1;
        let currentSortOrder = "asc";

        function sortTable(columnIndex) {
            const table = document.getElementById("playerTable");
            const rows = Array.from(table.rows).slice(1);
            const isNumeric = columnIndex === 5 || columnIndex === 6 || columnIndex === 2;

            rows.sort((rowA, rowB) => {
                const cellA = rowA.cells[columnIndex].innerText.trim();
                const cellB = rowB.cells[columnIndex].innerText.trim();

                let valA = isNumeric ? parseFloat(cellA) : cellA.toLowerCase();
                let valB = isNumeric ? parseFloat(cellB) : cellB.toLowerCase();

                if (valA < valB) {
                    return currentSortOrder === "asc" ? -1 : 1;
                } else if (valA > valB) {
                    return currentSortOrder === "asc" ? 1 : -1;
                } else {
                    return 0;
                }
            });

            // Entferne alte Zeilen und fÃ¼ge sortierte Zeilen ein
            rows.forEach(row => table.appendChild(row));

            // Setze die Sortierung zurÃ¼ck
            if (columnIndex === currentSortColumn) {
                currentSortOrder = currentSortOrder === "asc" ? "desc" : "asc";
            } else {
                currentSortOrder = "asc";
            }

            // Markiere die Spalte als sortiert
            Array.from(table.querySelectorAll("th")).forEach((th, index) => {
                th.classList.remove("sorted-asc", "sorted-desc");
                if (index === columnIndex) {
                    th.classList.add(currentSortOrder === "asc" ? "sorted-asc" : "sorted-desc");
                }
            });

            currentSortColumn = columnIndex;
        }
    </script>
</body>
</html>
